---
title: "Execute_on_powershell"
date: 2019-01-10T16:11:38+09:00
draft: false
---

Windows10環境で、自作の Python tool フォルダにパスを通して Powershell（Terminal）から実行しようとすると、期待した通りに実行できない。一瞬、ウィンドウが立ち上がっているようで、別プロセスとして実行されているようだ。

今回のツールは結果を標準出力に出力するようにしているため、これでは使えない。リダイレクトしてもカラファイルが出来るだけだった。

解決策としては、別プロセスで立ち上がるスクリプトの拡張子、今回であれば Python なので「.py」を、環境変数「PATHEXT」に追加すればいい。PATHEXT は、標準でシステム環境変数に定義されているが、システム環境変数は極力いじりたくないので、ユーザー環境変数に新たに PATHEXT を作り、値に「.PY」を加えた。うまく動いているようだ。

※ 大文字で登録したのは、既存の登録が大文字だったので合わせてだけ。小文字で設定しても動くようだ。

参考：<http://itasuke.hatenablog.com/entry/2017/11/27/145839>